package: apparmor

essential:
  - apparmor_copyright

slices:
  # Also relies on debconf, however it is solely used by install hook
  # to determine if any non default homedir has been configured.
  bins:
    essential:
      - apparmor_config
      - apparmor_profiles
      - libc6_libs
      - lsb-base_bins
    contents:
      /etc/init.d/apparmor:
      /sbin/apparmor_parser:
      /usr/bin/aa-enabled:
      /usr/bin/aa-exec:
      /usr/bin/aa-features-abi:
      /usr/sbin/aa-load:
      /usr/sbin/aa-remove-unknown:
      /usr/sbin/aa-status:
      /usr/sbin/aa-teardown:
      /usr/sbin/apparmor_status:

  config:
    contents:
      /etc/apparmor/parser.conf:
      /usr/lib/sysctl.d/10-apparmor.conf:

  extras:
    contents:
      /lib/apparmor/apparmor.systemd:
      /lib/apparmor/profile-load:
      /lib/apparmor/rc.apparmor.functions:
      /usr/lib/systemd/system/apparmor.service:

  profiles:
    contents:
      /etc/apparmor.d/1password:
      /etc/apparmor.d/Discord:
      /etc/apparmor.d/MongoDB_Compass:
      /etc/apparmor.d/QtWebEngineProcess:
      /etc/apparmor.d/abi/3.0:
      /etc/apparmor.d/abi/4.0:
      /etc/apparmor.d/abi/kernel-5.4-outoftree-network:
      /etc/apparmor.d/abi/kernel-5.4-vanilla:
      /etc/apparmor.d/abstractions/**:
      /etc/apparmor.d/brave:
      /etc/apparmor.d/buildah:
      /etc/apparmor.d/busybox:
      /etc/apparmor.d/cam:
      /etc/apparmor.d/ch-checkns:
      /etc/apparmor.d/ch-run:
      /etc/apparmor.d/chrome:
      /etc/apparmor.d/code:
      /etc/apparmor.d/crun:
      /etc/apparmor.d/devhelp:
      /etc/apparmor.d/element-desktop:
      /etc/apparmor.d/epiphany:
      /etc/apparmor.d/evolution:
      /etc/apparmor.d/firefox:
      /etc/apparmor.d/flatpak:
      /etc/apparmor.d/geary:
      /etc/apparmor.d/github-desktop:
      /etc/apparmor.d/goldendict:
      /etc/apparmor.d/ipa_verify:
      /etc/apparmor.d/kchmviewer:
      /etc/apparmor.d/keybase:
      /etc/apparmor.d/lc-compliance:
      /etc/apparmor.d/libcamerify:
      /etc/apparmor.d/linux-sandbox:
      /etc/apparmor.d/local/README:
      /etc/apparmor.d/loupe:
      /etc/apparmor.d/lsb_release:
      /etc/apparmor.d/lxc-attach:
      /etc/apparmor.d/lxc-create:
      /etc/apparmor.d/lxc-destroy:
      /etc/apparmor.d/lxc-execute:
      /etc/apparmor.d/lxc-stop:
      /etc/apparmor.d/lxc-unshare:
      /etc/apparmor.d/lxc-usernsexec:
      /etc/apparmor.d/mmdebstrap:
      /etc/apparmor.d/msedge:
      /etc/apparmor.d/nautilus:
      /etc/apparmor.d/notepadqq:
      /etc/apparmor.d/nvidia_modprobe:
      /etc/apparmor.d/obsidian:
      /etc/apparmor.d/opam:
      /etc/apparmor.d/opera:
      /etc/apparmor.d/pageedit:
      /etc/apparmor.d/plasmashell:
      /etc/apparmor.d/podman:
      /etc/apparmor.d/polypane:
      /etc/apparmor.d/privacybrowser:
      /etc/apparmor.d/qcam:
      /etc/apparmor.d/qmapshack:
      /etc/apparmor.d/qutebrowser:
      /etc/apparmor.d/rootlesskit:
      /etc/apparmor.d/rpm:
      /etc/apparmor.d/rssguard:
      /etc/apparmor.d/runc:
      /etc/apparmor.d/sbuild:
      /etc/apparmor.d/sbuild-abort:
      /etc/apparmor.d/sbuild-adduser:
      /etc/apparmor.d/sbuild-apt:
      /etc/apparmor.d/sbuild-checkpackages:
      /etc/apparmor.d/sbuild-clean:
      /etc/apparmor.d/sbuild-createchroot:
      /etc/apparmor.d/sbuild-destroychroot:
      /etc/apparmor.d/sbuild-distupgrade:
      /etc/apparmor.d/sbuild-hold:
      /etc/apparmor.d/sbuild-shell:
      /etc/apparmor.d/sbuild-unhold:
      /etc/apparmor.d/sbuild-update:
      /etc/apparmor.d/sbuild-upgrade:
      /etc/apparmor.d/scide:
      /etc/apparmor.d/signal-desktop:
      /etc/apparmor.d/slack:
      /etc/apparmor.d/slirp4netns:
      /etc/apparmor.d/steam:
      /etc/apparmor.d/stress-ng:
      /etc/apparmor.d/surfshark:
      /etc/apparmor.d/systemd-coredump:
      /etc/apparmor.d/thunderbird:
      /etc/apparmor.d/toybox:
      /etc/apparmor.d/trinity:
      /etc/apparmor.d/tunables/alias:
      /etc/apparmor.d/tunables/apparmorfs:
      /etc/apparmor.d/tunables/dovecot:
      /etc/apparmor.d/tunables/etc:
      /etc/apparmor.d/tunables/global:
      /etc/apparmor.d/tunables/home:
      /etc/apparmor.d/tunables/home.d/site.local:
      /etc/apparmor.d/tunables/home.d/ubuntu: {text: FIXME, mutable: true}
      /etc/apparmor.d/tunables/home.d/ubuntu.tmp:
        text: |
          # This file is auto-generated. It is recommended you update it using:
          # $ sudo dpkg-reconfigure apparmor
          #
          # The following is a space-separated list of where additional user home
          # directories are stored, each must have a trailing '/'. Directories added
          # here are appended to @{HOMEDIRS}.  See tunables/home for details.
          #@{HOMEDIRS}+=
        until: mutate
      /etc/apparmor.d/tunables/kernelvars:
      /etc/apparmor.d/tunables/multiarch:
      /etc/apparmor.d/tunables/multiarch.d/site.local:
      /etc/apparmor.d/tunables/proc:
      /etc/apparmor.d/tunables/run:
      /etc/apparmor.d/tunables/securityfs:
      /etc/apparmor.d/tunables/share:
      /etc/apparmor.d/tunables/sys:
      /etc/apparmor.d/tunables/xdg-user-dirs:
      /etc/apparmor.d/tunables/xdg-user-dirs.d/site.local: {text: FIXME, mutable: true}
      /etc/apparmor.d/tunables/xdg-user-dirs.d/site.local.tmp:
        text: |
          # ------------------------------------------------------------------
          #
          #    Copyright (C) 2014 Canonical Ltd.
          #    This program is free software; you can redistribute it and/or
          #    modify it under the terms of version 2 of the GNU General Public
          #    License published by the Free Software Foundation.
          #
          # ------------------------------------------------------------------
          # The following may be used to add additional entries such as for
          # translations. See tunables/xdg-user-dirs for details. Eg:
          #@{XDG_MUSIC_DIR}+="Musique"
          #@{XDG_DESKTOP_DIR}+=""
          #@{XDG_DOWNLOAD_DIR}+=""
          #@{XDG_TEMPLATES_DIR}+=""
          #@{XDG_PUBLICSHARE_DIR}+=""
          #@{XDG_DOCUMENTS_DIR}+=""
          #@{XDG_MUSIC_DIR}+=""
          #@{XDG_PICTURES_DIR}+=""
          #@{XDG_VIDEOS_DIR}+=""
        until: mutate
      /etc/apparmor.d/tup:
      /etc/apparmor.d/tuxedo-control-center:
      /etc/apparmor.d/unix-chkpwd:
      /etc/apparmor.d/unprivileged_userns:
      /etc/apparmor.d/userbindmount:
      /etc/apparmor.d/uwsgi-core:
      /etc/apparmor.d/vdens:
      /etc/apparmor.d/virtiofsd:
      /etc/apparmor.d/vivaldi-bin:
      /etc/apparmor.d/vpnns:
      /etc/apparmor.d/wpcom:
      /var/cache/apparmor/:
    mutate: |
      uc = content.read("/etc/apparmor.d/tunables/home.d/ubuntu.tmp")
      content.write("/etc/apparmor.d/tunables/home.d/ubuntu", uc)
      xc = content.read("/etc/apparmor.d/tunables/xdg-user-dirs.d/site.local.tmp")
      content.write("/etc/apparmor.d/tunables/xdg-user-dirs.d/site.local", xc)

  copyright:
    contents:
      /usr/share/doc/apparmor/copyright:
